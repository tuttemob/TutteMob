<?= $this->doctype() ?>

<html lang="pt">
    <head>
        <meta charset="utf-8">
        <?= $this->headTitle('TutteMob')->setSeparator(' - ')->setAutoEscape(false) ?>

        <?= 
        	$this->headMeta()
            ->appendName('viewport', 'width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no')
        ?>
        
        <link rel="shortcut icon" href="<?= $this->basePath('img/layout/logo-aba.png') ?>" type="image/x-icon">
        
		<!-- Bootstrap core CSS -->
	    <link href="<?= $this->basePath('lib/bootstrap/dist/css/bootstrap.min.css') ?>" rel="stylesheet">
	
	    <!-- Ícones do Google -->
	    <!-- <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"> -->
      
	    <!-- Custom styles -->
	    <link href="<?= $this->basePath('css/style.css') ?>" rel="stylesheet">
	    <link rel="stylesheet" href="<?= $this->basePath('lib/duplob/css/style-custom.css') ?>">
	
	    <!-- jQuery -->
	    <script src="<?= $this->basePath('lib/jquery/dist/jquery.min.js') ?>"></script>
	    <script src="<?= $this->basePath('lib/mask/jquery.mask.min.js') ?>"></script>
    </head>
    <body>
    	<nav class="navbar navbar-default navbar-fixed-top">
	      <div class="container-fluid">
	        <div class="navbar-header">
	          <a class="navbar-brand" href="<?= $this->url('home'); ?>">
	            <img alt="TutteMob" src="<?= $this->basePath('img/layout/logo-menu-preto.png') ?>" class="img-responsive" />
	          </a>
	        </div>
	
	        <ul class="nav navbar-nav navbar-right">
	        <?php if(!$this->usuario): ?>  
	          <li>
	            <a href="<?= $this->url('home'); ?>#section-quemsomos" title="Quem somos">
	              <img src="<?= $this->basePath('img/layout/quem-somos.png') ?>" class="img-responsive" />
	            </a>
	          </li>
	          <li>
	            <a href="<?= $this->url('home', array('action' => 'ambientes')); ?>" title="Ambientes">
	              <img src="<?= $this->basePath('img/layout/ambientes.png') ?>" class="img-responsive" />
	            </a>
	          </li>
	          <li>
	            <a href="<?= $this->url('home'); ?>#section-franquias-fisicas" title="Franquias Físicas">
	              <img src="<?= $this->basePath('img/layout/franquias-fisicas.png') ?>" class="img-responsive" />
	            </a>
	          </li>
	          <!-- 
	          <li>
	            <a href="<?= $this->url('home'); ?>#section-experiencia-clientes" title="Experiências de Clientes">
	              <img src="<?= $this->basePath('img/layout/experiencia-clientes.png') ?>" class="img-responsive" />
	            </a>
	          </li>
	           -->
	          <li>
	            <a href="<?= $this->url('home', array('action' => 'contatos')); ?>" title="Contatos">
	              <img src="<?= $this->basePath('img/layout/contato.png') ?>" class="img-responsive" />
	            </a>
	          </li>
	          <li>
	            <a href="<?= $this->url('login'); ?>" title="Login">
	              <img src="<?= $this->basePath('img/layout/login.png') ?>" class="img-responsive" />
	            </a>
	          </li>
	          <li>
	            <a href="<?= $this->url('home', array('action' => 'cadastrar')); ?>" title="Iniciar minha experiência TutteMob">
	              <img src="<?= $this->basePath('img/layout/iniciar-experiencia.png') ?>" class="img-responsive" />
	            </a>
	          </li>
					<?php else: ?>
						<li>
							<div class="usuario-avatar">
								<div class="usuario-avatar-text pull-left">
									AMBIENTES E PREFERÊNCIAS DE <?= strtoupper(reset(explode(' ',$this->usuario->nome))); ?>
								</div>
								<div class="usuario-avatar-img pull-left">
									<?php if($this->usuario->avatar): ?>
										<img src="<?= $this->basePath('upload/avatar/' . $this->usuario->avatar) ?>" class="img-thumbnail" />	
									<?php else: ?>
										<img src="<?= $this->basePath('img/layout/avatar.png') ?>" class="img-thumbnail" />	
									<?php endif; ?>
								</div>
							</div>
						</li>  
	          <li class="dropdown">
	            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
	            	<img src="<?= $this->basePath('img/layout/menu-login.png') ?>" class="img-responsive" />
	            </a>
	            <ul class="dropdown-menu menu-cliente">
	               
	              <li><a href="<?= $this->url('clientes'); ?>">Orçamentos</a></li>
	              
	              <li role="separator" class="divider"></li>
	              <li><a href="<?= $this->url('home'); ?>#section-quemsomos">Quem Somos?</a></li>
	              <li role="separator" class="divider"></li>
	              <li><a href="<?= $this->url('home', array('action' => 'ambientes')); ?>">Ambientes</a></li>
	              <li role="separator" class="divider"></li>
	              <li><a href="<?= $this->url('home'); ?>#section-franquias-fisicas">Franquias Físicas</a></li>
	              <!-- <li><a href="javascript:void(0)">Experiência de clientes</a></li> -->
	              <li role="separator" class="divider"></li>
	              <li><a href="#">Contato</a></li>
	              <li role="separator" class="divider"></li>
	              <li><a href="<?= $this->url('login', array('action' => 'logout')); ?>">Sair</a></li>
	            </ul>
	          </li>
	        <?php endif;?>
	        </ul>
	      </div>
	    </nav>
	
	    <div id="section-0" class="section col-lg-12"></div>
	
			<?= $this->layout()->content; ?>    
	
			<!-- Background frames -->
			<div id="background-frames"></div>

	    <!-- Bootstrap core JavaScript
	    ================================================== -->
	    <script src="<?= $this->basePath('lib/bootstrap/dist/js/bootstrap.min.js') ?>"></script>
	    <script src="<?= $this->basePath('lib/smooth-scroll/SmoothScroll.js') ?>"></script>
	    <script src="<?= $this->basePath('lib/duplob/js/bootstrap-validator.js') ?>"></script>
	
	    <!-- smooth scroll -->
	    <script type="text/javascript">
	      $(function(){
	          $('a').attr('href', function() {
	              if(/\#/.test(this.href)){
	                  var hrefParts = this.href.split(/#/);

	                  if('slideCarousel' != hrefParts[1]){
	                	  hrefParts[1] = 'smoothScroll' + hrefParts[1];	
	                  }
	                  
	                  return hrefParts.join('#');
	              }else{
	                  return this.href;
	              }
	          });
	
	          // executa ao carregar
	          var reSmooth = /^#smoothScroll/;
	          if (reSmooth.test(location.hash)) {
	              // Strip the "#smoothScroll" part off (and put "#" back on the beginning)
	              var id = '#' + location.hash.replace(reSmooth, '');
	              $.smoothScroll({scrollTarget: id});
	          }
	
	          $('a').on('click', function(){
	              var reSmooth = /#smoothScroll/;
	              if (reSmooth.test(this.href)) {
	                  var hrefParts = this.href.split(/#/);
	
	                  var id = '#' + ('#' + hrefParts[1]).replace(reSmooth, '');
	                  $.smoothScroll({scrollTarget: id});
	              }
	          });

						// Login com facebook
						$('#loginComFacebok').on('click', function(){
							FB.login(function(fbresponse){
								if (fbresponse.status == 'connected') {
									$.post(
										'<?= $this->url('login', array('action' => 'facebook')); ?>',
										{
											accessToken: fbresponse.authResponse.accessToken
										},
										function(lgresponse){
												if(lgresponse.data == 'success'){
														window.location = '<?= $this->url('clientes'); ?>';
												}else{
													alert(lgresponse.msg);
												}
										},'json'	
									);
								}
							}, {scope: 'public_profile,email'});
						});
	      });

				// Load the SDK asynchronously
				<?php $configFacebook = include './config/application.config.facebook.php'; ?>
				window.fbAsyncInit = function() {
					FB.init({
						appId      : '<?= $configFacebook['app_id']; ?>',
						cookie     : true,  // enable cookies to allow the server to access 
																// the session
						xfbml      : true,  // parse social plugins on this page
						version    : 'v2.8' // use graph api version 2.8
					});
				};
				(function(d, s, id) {
					var js, fjs = d.getElementsByTagName(s)[0];
					if (d.getElementById(id)) return;
					js = d.createElement(s); js.id = id;
					js.src = "//connect.facebook.net/en_US/sdk.js";
					fjs.parentNode.insertBefore(js, fjs);
				}(document, 'script', 'facebook-jssdk'));
	    </script>
    </body>
</html>
